# 多项目 Nginx 配置示例
# 服务器IP: 120.78.1.49

# ===== home-web 项目 (主域名/IP访问) =====
server {
    listen 80;
    server_name 120.78.1.49;  # 主IP访问
    
    root /var/www/home-web/dist;
    index index.html;
    
    access_log /var/log/nginx/home-web-access.log;
    error_log /var/log/nginx/home-web-error.log;
    
    # Vue Router 支持
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # 静态资源缓存
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # API代理
    location /api/ {
        proxy_pass http://120.78.1.49:8100/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    # 后端接口直接代理
    location ~ ^/(user|movie|movice|ai-chat|files)/ {
        proxy_pass http://120.78.1.49:8100;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        client_max_body_size 10M;
    }
    
    gzip on;
    gzip_types text/css application/javascript application/json;
}

# ===== 其他项目示例 1: 通过端口区分 =====
server {
    listen 8080;  # 不同端口
    server_name 120.78.1.49;
    
    root /var/www/another-project/dist;
    index index.html;
    
    access_log /var/log/nginx/another-project-access.log;
    error_log /var/log/nginx/another-project-error.log;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # 这个项目的API代理到不同端口
    location /api/ {
        proxy_pass http://120.78.1.49:8200/;  # 不同的后端端口
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

# ===== 其他项目示例 2: 通过路径区分 =====
server {
    listen 80;
    server_name 120.78.1.49;
    
    # 管理后台项目 - 通过 /admin 路径访问
    location /admin/ {
        alias /var/www/admin-panel/dist/;
        try_files $uri $uri/ /admin/index.html;
        
        # 管理后台的API代理
        location /admin/api/ {
            proxy_pass http://120.78.1.49:8300/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    
    # 移动端项目 - 通过 /mobile 路径访问
    location /mobile/ {
        alias /var/www/mobile-app/dist/;
        try_files $uri $uri/ /mobile/index.html;
        
        # 移动端API代理
        location /mobile/api/ {
            proxy_pass http://120.78.1.49:8400/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
}

# ===== 其他项目示例 3: 通过子域名区分（如果有域名） =====
# server {
#     listen 80;
#     server_name admin.yourdomain.com;  # 子域名
#     
#     root /var/www/admin-system/dist;
#     index index.html;
#     
#     location / {
#         try_files $uri $uri/ /index.html;
#     }
#     
#     location /api/ {
#         proxy_pass http://120.78.1.49:8500/;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     }
# }






